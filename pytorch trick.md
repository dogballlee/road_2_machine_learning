# pytorch trick



## torchvision.models

**torchvision.models**ä¸­å·²åŒ…å«ä»¥ä¸‹æ¨¡å‹ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ï¼š

import torchvision.models as models
resnet18 = models.resnet18()
alexnet = models.alexnet()
vgg16 = models.vgg16()
squeezenet = models.squeezenet1_0()
densenet = models.densenet161()
inception = models.inception_v3()
googlenet = models.googlenet()
shufflenet = models.shufflenet_v2_x1_0()
mobilenet = models.mobilenet_v2()
resnext50_32x4d = models.resnext50_32x4d()
wide_resnet50_2 = models.wide_resnet50_2()
mnasnet = models.mnasnet1_0()

é€šè¿‡æ·»åŠ å‚æ•°pretrainde=Trueï¼Œå¯ä»¥åŠ è½½åœ¨imagenetä¸Šé¢„è®­ç»ƒçš„æ¨¡å‹ï¼Œä¾‹ï¼šresnet18 = models.resnet18(pretrained=True)

ï¼ˆ**imagenetä¸­è¾“å…¥å›¾ç‰‡éƒ½æ˜¯3é€šé“ï¼Œå¹¶ä¸”è¾“å…¥å›¾ç‰‡çš„å®½é«˜ä¸å°äº224åƒç´ ï¼Œå¹¶ä¸”è¦æ±‚è¾“å…¥å›¾ç‰‡åƒç´ å€¼çš„èŒƒå›´åœ¨0åˆ°1ä¹‹é—´ï¼Œç„¶ååšä¸€ä¸ªnormalizationæ ‡å‡†åŒ–ã€‚**ï¼‰



torchvisionå®˜æ–¹æä¾›çš„ä¸åŒæ¨¡å‹åœ¨imagenetæ•°æ®é›†ä¸Šçš„é”™è¯¯ç‡ï¼Œå¯ä½œä¸ºå‚è€ƒï¼š

| ç½‘ç»œ           | Top-1 error | Top-5 error |
| :------------- | :---------- | :---------- |
| AlexNet        | 43.45       | 20.91       |
| VGG-11         | 30.98       | 11.37       |
| VGG-13         | 30.07       | 10.75       |
| VGG-16         | 28.41       | 9.62        |
| VGG-19         | 27.62       | 9.12        |
| VGG-13 with BN | 28.45       | 9.63        |
| VGG-19 with BN | 25.76       | 8.15        |
| Resnet-18      | 30.24       | 10.92       |
| Resnet-34      | 26.70       | 8.58        |
| Resnet-50      | 23.85       | 7.13        |
| Resnet-101     | 22.63       | 6.44        |
| Resnet-152     | 21.69       | 5.94        |
| SqueezeNet 1.1 | 41.81       | 19.38       |
| Densenet-161   | 22.35       | 6.2         |



## MNISTæ•°æ®é›†ç»“æ„

è®­ç»ƒæ•°æ®é›†ï¼štrain-images-idx3-ubyte.gz ï¼ˆ9.45 MBï¼ŒåŒ…å«60,000ä¸ªæ ·æœ¬ï¼‰ã€‚
è®­ç»ƒæ•°æ®é›†æ ‡ç­¾ï¼štrain-labels-idx1-ubyte.gzï¼ˆ28.2 KBï¼ŒåŒ…å«60,000ä¸ªæ ‡ç­¾ï¼‰ã€‚
æµ‹è¯•æ•°æ®é›†ï¼št10k-images-idx3-ubyte.gzï¼ˆ1.57 MB ï¼ŒåŒ…å«10,000ä¸ªæ ·æœ¬ï¼‰ã€‚
æµ‹è¯•æ•°æ®é›†æ ‡ç­¾ï¼št10k-labels-idx1-ubyte.gzï¼ˆ4.43 KBï¼ŒåŒ…å«10,000ä¸ªæ ·æœ¬çš„æ ‡ç­¾ï¼‰ã€‚



## tqdmæ˜¯ä¸ªéªšé“å…·ï¼ˆå¾…è¡¥å®Œï¼‰

`import tqdm`

å¯¼å…¥åtqdmå¯ç”¨äºæ‰€æœ‰å¯è¿­ä»£å¯¹è±¡ï¼Œæ•…è€Œåœ¨pytorchçš„dataloaderçš„ä½¿ç”¨åœºæ™¯ä¸‹ï¼Œå¯ä»¥è¿™æ ·ä½¿ç”¨ï¼š

```python
for data, target in tqdm(train_loader):`

	`......
```

ï¼ˆçœç•¥å·ä¸­ä¸ºå¾ªç¯å†…çš„å„ç§æ“ä½œï¼Œå¯ä»¥æ­£å¸¸å¯¹batchå†…çš„dataè¿›è¡Œåç»­å¤„ç†ï¼Œå¹¶æ˜¾ç¤ºè¿›åº¦æ¡ï¼‰

åŸç†ï¼šè¿™ç§ç”¨æ³•ç›¸å½“äºåœ¨dataloaderä¸Šå¯¹æ¯ä¸ªbatchå’Œbatchæ€»æ•°åšçš„è¿›åº¦æ¡





## torchè®­ç»ƒä¸­çš„éœ€æ³¨æ„çš„ç‚¹

æ­£å‘ä¼ æ’­åçš„æ¢¯åº¦æ˜¯å‚¨å­˜åœ¨å‰ä¸€stepä¸­çš„ï¼Œåœ¨è¿›è¡Œbackward()å‰è¦å…ˆå½’é›¶ï¼Œå¦åˆ™æ¢¯åº¦ä¼šè¢«ç´¯åŠ èµ·æ¥ï¼Œä¸è¦æåäº†ï¼

```python
	......
	# Gradients stored in the parameters in the previous step should be cleared out first.
	optimizer.zero_grad()
	# Compute the gradients for parameters.
	loss.backward()
	# Update the parameters with computed gradients.
	optimizer.step()
    ......
```





## model.parameters()ä¸model.state_dict()

*model.parameters()*ä¸*model.state_dict()*æ˜¯Pytorchä¸­ç”¨äºæŸ¥çœ‹ç½‘ç»œå‚æ•°çš„æ–¹æ³•ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå‰è€…**å¤šè§äºä¼˜åŒ–å™¨çš„åˆå§‹åŒ–**ï¼Œä¾‹å¦‚ï¼š

![img](https://pic4.zhimg.com/80/v2-5c9bbd19ac058c725550d6a800ca19b7_720w.jpg)

åè€…**å¤šè§äºæ¨¡å‹çš„ä¿å­˜**ï¼Œå¦‚ï¼š

![img](https://pic1.zhimg.com/80/v2-a52f44627d28ae6339adae1950a0de34_720w.jpg)





## sklearnä¸­ KFold å’Œ StratifiedKFold å·®åˆ«

**KFoldåˆ’åˆ†æ•°æ®é›†**ï¼šæ ¹æ®n_splitç›´æ¥è¿›è¡Œé¡ºåºåˆ’åˆ†ï¼Œä¸è€ƒè™‘æ•°æ®labelåˆ†å¸ƒ
**StratifiedKFoldåˆ’åˆ†æ•°æ®é›†**ï¼šåˆ’åˆ†åçš„è®­ç»ƒé›†å’ŒéªŒè¯é›†ä¸­ç±»åˆ«åˆ†å¸ƒå°½é‡å’ŒåŸæ•°æ®é›†ä¸€æ ·

**exampleï¼š**

```python
from sklearn.model_selection import KFold
from sklearn.model_selection import StratifiedKFold
import numpy as np

X = np.array([[10, 1], [20, 2], [30, 3], [40, 4], [50, 5], [60, 6], [70, 7], [80, 8], [90, 9], [100, 10], [90, 9], [100, 10]])

# ä¸¤ä¸ªç±»åˆ«ï¼š1:1

Y = np.array([1,1,1,1,1,1,2,2,2,2,2,2])

print("Start Testing KFold...")

# KFoldåˆ’åˆ†æ•°æ®é›†çš„åŸç†ï¼šæ ¹æ®n_splitç›´æ¥è¿›è¡Œé¡ºåºåˆ’åˆ†

`kfolds = KFold(n_splits=3, shuffle=False)`
`for (trn_idx, val_idx) in kfolds.split(X, Y):`
    `print((trn_idx, val_idx))`
    `print((len(trn_idx), len(val_idx)))`


`print('\n' + "Start Testing StratifiedKFold...")`

# `StratifiedKFold: æŠ½æ ·åçš„è®­ç»ƒé›†å’ŒéªŒè¯é›†çš„æ ·æœ¬åˆ†ç±»æ¯”ä¾‹å’ŒåŸæœ‰çš„æ•°æ®é›†å°½é‡æ˜¯ä¸€æ ·çš„`

`stratifiedKFolds = StratifiedKFold(n_splits=3, shuffle=False)`
`for (trn_idx, val_idx) in stratifiedKFolds.split(X, Y):`
    `print((trn_idx, val_idx))`
    `print((len(trn_idx), len(val_idx)))`

```





## æ•°æ®å¢å¼ºåº“ã€Œalbumentationsã€----å€¼å¾—å­¦ä¹ 

1. æˆ‘çš„å®˜æ–¹åœ°å€åœ¨ githubé“¾æ¥ï¼š

   https://github.com/albumentations-team/albumentations

2. æˆ‘çš„APIï¼ˆæ–‡æ¡£ï¼‰åœ°å€åœ¨

   https://albumentations.ai/docs/

3. æˆ‘æ˜¯è´Ÿè´£å¤„ç†å›¾åƒçš„ä¸€ä¸ªåº“ï¼Œå¯ç”¨äºæ‰€æœ‰æ•°æ®ç±»å‹ï¼šå›¾åƒï¼ˆRBGå›¾åƒï¼Œç°åº¦å›¾åƒï¼Œå¤šå…‰è°±å›¾åƒï¼‰ï¼Œåˆ†å‰²maskï¼Œè¾¹ç•Œæ¡†å’Œå…³é”®ç‚¹

4. æˆ‘å¤§æ¦‚æœ‰70å¤šç§ä¸åŒçš„å›¾åƒå¤„ç†æ–¹æ³•,ç›¸æ¯”torchè‡ªå¸¦çš„ï¼Œè¿™ä¸ªåº“å‡½æ•°æœ‰æ›´å¤šçš„å¯¹å›¾åƒçš„é¢„å¤„ç†çš„åŠæ³•

5. æˆ‘çš„ç‰¹ç‚¹å°±æ˜¯**å¿«**ï¼šåœ¨ç›¸åŒçš„å¯¹å›¾åƒçš„å¤„ç†ä¸‹ï¼Œæˆ‘çš„é€Ÿåº¦å°±æ˜¯æ¯”å…¶ä»–å¤„ç†æ–¹å¼æ›´å¿«ğŸ‘

   ![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/UgCGraybEsStqiaq02J7c8qvOdLHuD4EcCOMYoHbD9dzVxibiaapeudSaZBicibXZicFcQicdJrEYWJnb20xqU02KGX0g/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

   è¿™ä¸ªå›¾ä¸­ï¼Œå¯ä»¥çœ‹åˆ°albumentationsçš„å¤„ç†æ–¹æ³•ä¸­ï¼Œå¾ˆå¤šéƒ½æ˜¯é€Ÿåº¦æœ€å¿«çš„ã€‚

6. æˆ‘å¯ä»¥ä¸æµè¡Œçš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ˆä¾‹å¦‚PyTorchå’ŒTensorFlowï¼‰ä¸€èµ·ä½¿ç”¨ã€‚é¡ºä¾¿è¯´ä¸€å¥ï¼Œæˆ‘è¿˜æ˜¯PyTorchç”Ÿæ€ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†

7. å¯¹Pytorchå¾ˆå‹å¥½ï¼Œè€Œä¸”è¿™ä¸ªåº“å‡½æ•°æ˜¯kaggle masteråˆ¶ä½œçš„

8. å¹¿æ³›ç”¨äºå·¥ä¸šï¼Œæ·±åº¦å­¦ä¹ ç ”ç©¶ï¼Œæœºå™¨å­¦ä¹ ç«èµ›å’Œå¼€æºé¡¹ç›®ã€‚å°±æ˜¯å¤§ä½¬éƒ½çˆ±ç”¨çš„ä¸€ä¸ªåº“ï¼Œåœ¨kaggleæ¯”èµ›ä¸Šéƒ½æœ‰æˆ‘çš„èº«å½±ã€‚





## tensorboard æ— æ³•è¿æ¥é—®é¢˜

åˆ‡æ¢è‡³logç›®å½•

åœ¨terminalä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤(ä¾‹)ï¼š

```python
tensorboard --logdir=D:\XXX\log --host=127.0.0.1
```



å°†ä¼šå¾—åˆ°ä¸€ä¸ªåœ°å€

å¤åˆ¶åœ°å€åˆ°æµè§ˆå™¨å³å¯



## TIMMåº“â€”â€”torch.modelsä¹‹å¤–çš„å¯é€‰é¡¹

ç›¸è¾ƒäºtorch.modelsï¼ŒTIMMï¼ˆpy**T**orch-**IM**age-**M**odelsï¼‰æ˜¯ä¸€ä¸ªä¼˜ç§€çš„å¯é€‰é¡¹ï¼Œæ‹¥æœ‰è¿œå¤§äºmodelsçš„å„ä¸ªç”¨äºå›¾åƒåˆ†ç±»çš„é¢„è®­ç»ƒæ¨¡å‹(ç›¸æ¯”ä¹‹ä¸‹ä¹Ÿæ¯”è¾ƒæ–°)



## pythonä¸­çš„selfç©¶ç«ŸæŒ‡çš„æ˜¯å•¥ï¼Ÿ

Answerï¼šå®ä¾‹åŒ–åçš„ç±»æœ¬èº«ï¼ˆè¦ç‚¹ï¼šå®ä¾‹åŒ–åçš„å®ä¾‹ï¼Œè€Œéç±»æœ¬èº«ï¼‰





## nn.Conv2dä¸nn.functional.conv2d

torch.nn.Conv2dä¸»è¦æ˜¯åœ¨å„ç§ç»„åˆçš„torch.nn.Sequentialä¸­ä½¿ç”¨ï¼Œæ„å»ºCNNæ¨¡å‹ã€‚torch.nn.functional.conv2dæ›´å¤šæ˜¯åœ¨å„ç§è‡ªå®šä¹‰ä¸­ä½¿ç”¨ï¼Œéœ€è¦æ˜ç¡®æŒ‡å‡ºè¾“å…¥ä¸æƒé‡filterså‚æ•°ã€‚





## å·ç§¯æ“ä½œåçš„å°ºå¯¸æ€æ ·è®¡ç®—ï¼Ÿ

è¾“å…¥å›¾ç‰‡å¤§å° **WÃ—W**
å·ç§¯æ ¸å¤§å° **FÃ—F**
æ­¥é•¿ **S**
paddingçš„åƒç´ æ•° **P**
äºæ˜¯æˆ‘ä»¬å¯ä»¥å¾—å‡ºè®¡ç®—å…¬å¼ä¸ºï¼š
**N = (W âˆ’ F + 2P )/S+1**

è¾“å‡ºå›¾ç‰‡å¤§å°ä¸º **NÃ—N**
ä»¥resnet50ä¸ºä¾‹ï¼Œè¾“å…¥ä¸º[1,3,224,224]ï¼Œå…¶ä¸­1ä¸ºbatchsizeï¼Œ3ä¸ºé€šé“æ•°ï¼Œ224ä¸ºheightå’Œwidthã€‚

ç»è¿‡ç¬¬ä¸€å±‚å·ç§¯åï¼Œå…¶å¤§å°ä¸º[1,64,112,112]

**ä¾‹ï¼š**

```python
nn.Conv2d(in_channels, out_channels, kernel_size=7, stride=2, padding=3, bias=False)
```

**è§£é‡Šï¼š**
1ä¸ºbatch sizeï¼Œä¸æ”¹å˜ã€‚
å¯¹äºé€šé“æ•°ï¼Œä¼šç”Ÿæˆä¸è®¾å®šçš„è¾“å‡ºé€šé“ä¸ªæ•°ç›¸åŒä¸ªæ•°çš„å·ç§¯æ ¸ï¼Œå¯¹å›¾ç‰‡è¿›è¡Œå·ç§¯ï¼Œå³å·ç§¯æ ¸çš„ä¸ªæ•°ç­‰äºè¾“å‡ºç‰¹å¾å›¾çš„é€šé“æ•°ã€‚
å¾—åˆ°æœ€ç»ˆè¾“å‡ºå¤§å°ä¸º[1,64,112,112]
(W âˆ’ F + 2P )ç›¸å½“äºè®¡ç®—é™¤äº†ç¬¬ä¸€æ¬¡å·ç§¯åå‰©ä¸‹çš„å¯ç”¨æ¥å·ç§¯çš„å¤§å°
(W âˆ’ F + 2P )/Sä¸ºæŒ‰ç…§Så¤§å°çš„æ­¥é•¿åœ¨åˆšåˆšå¾—åˆ°çš„å¤§å°ä¸Šå¯ä»¥å‘åç§»åŠ¨å¤šå°‘æ¬¡ï¼Œå³è¿˜å¯ä»¥åšå‡ æ¬¡å·ç§¯
å› ä¸ºä¸åŒ…æ‹¬ç¬¬ä¸€æ¬¡å·ç§¯ï¼Œæ‰€ä»¥å†åŠ ä¸Šä¸€ä¸ª1ï¼Œ
å³N = (W âˆ’ F + 2P )/S+1
è¾“å‡ºå¤§å° = ï¼ˆå›¾ç‰‡å®½æˆ–é«˜ - å·ç§¯æ ¸å¤§å° + paddingå¤§å°ï¼‰/ æ­¥é•¿ + 1
å¯¹äºå®½å’Œé«˜ä¸åŒçš„å›¾ç‰‡å¯åˆ†åˆ«ç”¨ä¸Šè¿°å…¬å¼è®¡ç®—ï¼Œå¾—åˆ°æœ€ç»ˆçš„è¾“å‡ºå¤§å°ã€‚

å·ç§¯åŠ¨æ€å›¾è§£å‚è€ƒï¼š
https://cs231n.github.io/assets/conv-demo/index.html



## darknet-53å¾—ååŸå› 

darknet-53ä½œä¸ºæå–ç‰¹å¾çš„backboneè¢«ä½¿ç”¨äºYOLOv3ä¸­ï¼Œå…¶æ¥æºäºdarknet-19ï¼ˆé¦–æ¬¡ä½¿ç”¨äºYOLOv2ï¼Œæ€è·¯æºäºresnetï¼‰ï¼Œ53ä¸19åˆ†åˆ«æŒ‡è¯¥ç½‘ç»œç»“æ„ä¸­å·ç§¯å±‚çš„ä¸ªæ•°ï¼ˆ2 + 1Ã—2 + 1 + 2Ã—2 + 1 + 8Ã—2 + 1 + 8Ã—2 + 1 + 4Ã—2 + 1 = 53 æŒ‰ç…§é¡ºåºæ•°ï¼Œ<u>æœ€åçš„Connectedæ˜¯å…¨è¿æ¥å±‚ä¹Ÿç®—å·ç§¯å±‚</u>ï¼Œä¸€å…±53ä¸ªï¼‰

**å›¾1ï¼š**

![img](https://img-blog.csdn.net/20180726102742325?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3NTQxMDk3/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

**å›¾2ï¼š**

![img](https://camo.githubusercontent.com/99ff785d707dfec472c7ee386b83631952774002e6179f49f8c8ed141d2e11c9/68747470733a2f2f696d672d626c6f672e6373646e696d672e636e2f323031393034303231313038343035302e6a70673f782d6f73732d70726f636573733d696d6167652f77617465726d61726b2c747970655f5a6d46755a33706f5a57356e6147567064476b2c736861646f775f31302c746578745f6148523063484d364c7939696247396e4c6d4e7a5a473475626d56304c334678587a4d334e5451784d446b332c73697a655f31362c636f6c6f725f4646464646462c745f3730)

åœ¨**å›¾2**ä¸­æˆ‘ä»¬èƒ½å¤Ÿå¾ˆæ¸…æ™°çš„çœ‹åˆ°ä¸‰ä¸ªé¢„æµ‹å±‚åˆ†åˆ«æ¥è‡ªçš„ä»€ä¹ˆåœ°æ–¹ï¼Œä»¥åŠConcatenateå±‚ä¸å“ªä¸ªå±‚è¿›è¡Œæ‹¼æ¥ã€‚**æ³¨æ„Convolutionalæ˜¯æŒ‡Conv2d+BN+LeakyReLUï¼Œå’ŒDarknet53å›¾ä¸­çš„ä¸€æ ·ï¼Œè€Œç”Ÿæˆé¢„æµ‹ç»“æœçš„æœ€åä¸‰å±‚éƒ½åªæ˜¯Conv2d**



## embedding(åµŒå…¥å±‚)ç©¶ç«Ÿæ˜¯ä¸ªå•¥

ä¸ºäº†è§£å†³ç‰¹å¾ç¨€ç–é€ æˆçš„ä¸€ç³»åˆ—é—®é¢˜(<u>ç¨€ç–è¡¨ç¤ºå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œè¿™äº›é—®é¢˜å¯èƒ½ä½¿æ¨¡å‹éš¾ä»¥æœ‰æ•ˆå­¦ä¹ ã€‚ä¸»è¦é—®é¢˜æ˜¯æ„é€ çš„ont-hot vectorå¤ªå¤§ä»¥åŠvectorä¹‹é—´è·ç¦»åˆ»ç”»é—®é¢˜</u>)ï¼Œè€Œé‡‡å–çš„å°†å¤§å‹ç¨€ç–å‘é‡è½¬æ¢ä¸ºä¿ç•™è¯­ä¹‰å…³ç³»çš„ä½ç»´ç©ºé—´çš„æ–¹æ³•ã€‚å¸¸ç”¨çš„æ–¹æ³•æœ‰ï¼š

â€‹				**ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰**ï¼šå·²ç”¨äºåˆ›å»ºå•è¯embeddingã€‚ç»™å®šä¸€ç»„åƒè¯è¢‹å‘é‡ä¸€æ ·çš„å®ä¾‹ï¼ŒPCAè¯•å›¾æ‰¾åˆ°å¯ä»¥æŠ˜å æˆå•ä¸ªç»´åº¦çš„é«˜åº¦ç›¸å…³çš„ç»´åº¦ã€‚

â€‹				**Word2vec**ï¼šä¾èµ–äºåˆ†å¸ƒå‡è®¾(distributional hypothesis)æ¥å°†è¯­ä¹‰ç›¸ä¼¼çš„è¯æ˜ å°„åˆ°å‡ ä½•ä¸Šç›¸è¿‘çš„embeddingå‘é‡ã€‚



## DLå¸¸ç”¨çš„æ¿€æ´»å‡½æ•°

![](C:\Users\Administrator\Desktop\å¸¸ç”¨æ¿€æ´»å‡½æ•°.png)



# @staticmethodå’Œ@classmethodçš„ç”¨æ³•

**ä¸€èˆ¬æ¥è¯´ï¼Œè¦ä½¿ç”¨æŸä¸ªç±»çš„æ–¹æ³•ï¼Œéœ€è¦å…ˆå®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡å†è°ƒç”¨æ–¹æ³•ã€‚**
**è€Œä½¿ç”¨@staticmethodæˆ–@classmethodï¼Œå°±å¯ä»¥ä¸éœ€è¦å®ä¾‹åŒ–ï¼Œç›´æ¥ç±»å.æ–¹æ³•å()æ¥è°ƒç”¨ã€‚**
è¿™æœ‰åˆ©äºç»„ç»‡ä»£ç ï¼ŒæŠŠæŸäº›åº”è¯¥å±äºæŸä¸ªç±»çš„å‡½æ•°ç»™æ”¾åˆ°é‚£ä¸ªç±»é‡Œå»ï¼ŒåŒæ—¶æœ‰åˆ©äºå‘½åç©ºé—´çš„æ•´æ´ã€‚

ä¸¤è€…åŒºåˆ«åœ¨äºï¼š

- @staticmethodä¸éœ€è¦è¡¨ç¤ºè‡ªèº«å¯¹è±¡çš„selfå’Œè‡ªèº«ç±»çš„clså‚æ•°ï¼Œå°±è·Ÿä½¿ç”¨å‡½æ•°ä¸€æ ·ã€‚

- @classmethodä¹Ÿä¸éœ€è¦selfå‚æ•°ï¼Œä½†ç¬¬ä¸€ä¸ªå‚æ•°éœ€è¦æ˜¯è¡¨ç¤ºè‡ªèº«ç±»çš„clså‚æ•°ã€‚

    å¦‚æœåœ¨@staticmethodä¸­è¦è°ƒç”¨åˆ°è¿™ä¸ªç±»çš„ä¸€äº›å±æ€§æ–¹æ³•ï¼Œåªèƒ½ç›´æ¥ç±»å.å±æ€§åæˆ–ç±»å.æ–¹æ³•åã€‚
    è€Œ@classmethodå› ä¸ºæŒæœ‰clså‚æ•°ï¼Œå¯ä»¥æ¥è°ƒç”¨ç±»çš„å±æ€§ï¼Œç±»çš„æ–¹æ³•ï¼Œå®ä¾‹åŒ–å¯¹è±¡ç­‰ï¼Œé¿å…ç¡¬ç¼–ç ã€‚



## äº¤å‰ç†µå’Œç›¸å¯¹ç†µï¼ˆKLæ•£åº¦ï¼‰ï¼Ÿ

KLæ•£åº¦æ˜¯ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒPå’ŒQå·®åˆ«çš„éå¯¹ç§°æ€§çš„åº¦é‡ã€‚å…¸å‹æƒ…å†µä¸‹ï¼ŒPè¡¨ç¤ºæ•°æ®çš„çœŸå®åˆ†å¸ƒï¼ŒQè¡¨ç¤ºæ•°æ®çš„ç†è®ºåˆ†å¸ƒï¼Œæ¨¡å‹åˆ†å¸ƒï¼Œæˆ–Pçš„è¿‘ä¼¼åˆ†å¸ƒã€‚

$D_{KL}=\sum P(i) log\frac {P(i)}{Q(i)}=\sum_{i}P(i)logP(i)-\sum_{i}P(i)logQ(i)$

è¿™é‡Œæ³¨æ„ï¼šç”±äºPå’ŒQåœ¨å…¬å¼ä¸­çš„åœ°ä½ä¸æ˜¯ç›¸ç­‰çš„ï¼Œæ‰€ä»¥ $D_{KL}(P||Q)\neq D_{KL}(Q||P)$ã€‚åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œç”±äºçœŸå®çš„æ¦‚ç‡åˆ†å¸ƒæ˜¯å›ºå®šçš„ï¼Œå‰åŠéƒ¨åˆ†æ˜¯ä¸ªå¸¸æ•°ã€‚é‚£ä¹ˆå¯¹KLæ•£åº¦çš„ä¼˜åŒ–å°±ç›¸å½“äºä¼˜åŒ–ååŠéƒ¨åˆ†ã€‚

ç›¸å¯¹ç†µå…¬å¼çš„ååŠéƒ¨åˆ†å°±æ˜¯äº¤å‰ç†µ $CrossEntropy=-\sum_{i}P(i)\log Q(i)$



## å·ç§¯ç‰¹ç‚¹æ€»ç»“

å·ç§¯ç½‘ç»œè”åˆäº†ä¸‰ä¸ªæ¶æ„ç‰¹å¾å¯¼è‡´äº†è½¬æ¢ã€æ‹‰ä¼¸å’Œæ‰­æ›²çš„ä¸å˜å½¢ï¼š

â€‹		ï¼ˆ1ï¼‰**å±€éƒ¨æ„Ÿå—é‡**ï¼ˆLocal Receptive Fieldsï¼‰ï¼›

â€‹		ï¼ˆ2ï¼‰**å…±äº«æƒé‡**ï¼ˆShared Weightsï¼‰ï¼›

â€‹		ï¼ˆ3ï¼‰**æ—¶é—´å’Œç©ºé—´çš„äºŒæ¬¡æŠ½æ ·**ï¼ˆSpatial or Temporal Subsamplingï¼‰ã€‚

 

å·ç§¯çš„ä½œç”¨ï¼š

ã€€ã€€ï¼ˆ1ï¼‰å¼•å…¥ç¨€ç–æˆ–å±€éƒ¨è¿æ¥ï¼Œçº¦å‡ä¸å¿…è¦çš„æƒå€¼è¿æ¥

ã€€ã€€ï¼ˆ2ï¼‰æƒå€¼å…±äº«ï¼Œå‡å°‘å‚æ•°é‡

ã€€ã€€ï¼ˆ3ï¼‰å¹³ç§»ä¸å˜æ€§

ã€€ã€€ï¼ˆ4ï¼‰é¿å…è¿‡æ‹Ÿåˆç°è±¡

 

æ± åŒ–çš„ä½œç”¨ï¼š

ã€€ã€€ï¼ˆ1ï¼‰å‡å°‘è®¡ç®—é‡ï¼Œåˆ»ç”»å¹³ç§»ä¸å˜æ€§

ã€€ã€€ï¼ˆ2ï¼‰çº¦å‡ä¸‹ä¸€å±‚è¾“å…¥çš„ç»´æ•°ï¼ˆå‚æ•°é‡é™ä½ï¼‰

ã€€ã€€ï¼ˆ3ï¼‰é¿å…è¿‡æ‹Ÿåˆ



## æ—¶é—´å¤æ‚åº¦

$O(N!)>o(2^n)>O(N^2)>O(nlgn)>O(n)>O(1)=O(lgn)$

